# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/watchdog/qcom-wdt.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Qualcomm Krait Processor Sub-system (KPSS) Watchdog timer

maintainers:
  - Sai Prakash Ranjan <saiprakash.ranjan@codeaurora.org>

allOf:
  - if:
      properties:
        compatible:
          contains:
            const: qcom,msm-timer
    then:
      properties:
        $nodename:
          pattern: '^timer@[a-f0-9]+$'

        interrupts:
          minItems: 1
          items:
            - description: 1st purpose timer
            - description: 2nd general purpose timer
            - description: 1st watchdog interrupt
            - description: 2nd watchdog interrupt
            - description: 3nd watchdog interrupt

        cpu-offset:
          $ref: /schemas/types.yaml#/definitions/uint32
          description: >
            Per-cpu offset used when the timer is accessed without the
            CPU remapping facilities. The offset is cpu-offset + (0x10000 * cpu-nr).

      required:
        - interrupts
        - clock-frequency

    else:
      $ref: watchdog.yaml#
      properties:
        interrupts:
          maxItems: 1

        cpu-offset: false

        timeout-sec: true

      required:
        - clocks

      unevaluatedProperties: false

properties:
  compatible:
    oneOf:
      - items:
          - enum:
              - qcom,apss-wdt-qcs404
              - qcom,apss-wdt-sc7180
              - qcom,apss-wdt-sc7280
              - qcom,apss-wdt-sdm845
              - qcom,apss-wdt-sdx55
              - qcom,apss-wdt-sm6350
              - qcom,apss-wdt-sm8150
              - qcom,apss-wdt-sm8250
          - const: qcom,kpss-wdt
      - items:
          - enum:
              - qcom,kpss-wdt
              - qcom,kpss-timer
              - qcom,kpss-wdt-apq8064
              - qcom,kpss-wdt-ipq4019
              - qcom,kpss-wdt-ipq8064
              - qcom,kpss-wdt-msm8960
              - qcom,scss-timer

  reg:
    maxItems: 1

  clocks:
    maxItems: 1

  clock-names:
    maxItems: 1

  interrupts: true

  clock-frequency: true

  cpu-offset: true

required:
  - compatible
  - reg

additionalProperties: false
unevaluatedProperties: false

examples:
  - |
    watchdog@208a038 {
      compatible = "qcom,kpss-wdt-ipq8064";
      reg = <0x0208a038 0x40>;
      clocks = <&sleep_clk>;
      timeout-sec = <10>;
    };
